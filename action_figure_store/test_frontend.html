<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API 測試頁面</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h1>API 測試頁面</h1>
        
        <div class="row">
            <div class="col-md-6">
                <h3>分類資料</h3>
                <div id="categories-result">載入中...</div>
            </div>
            <div class="col-md-6">
                <h3>商品資料</h3>
                <div id="products-result">載入中...</div>
            </div>
        </div>
    </div>

    <script>
        // 測試分類 API
        fetch('api/categories.php')
            .then(response => response.json())
            .then(data => {
                console.log('分類資料:', data);
                const container = document.getElementById('categories-result');
                
                if (data.success && data.categories) {
                    let html = '<ul>';
                    data.categories.forEach(cat => {
                        html += `<li><strong>${cat.name}</strong> (ID: ${cat.id})`;
                        if (cat.children && cat.children.length > 0) {
                            html += '<ul>';
                            cat.children.forEach(child => {
                                html += `<li>${child.name} (ID: ${child.id})</li>`;
                            });
                            html += '</ul>';
                        }
                        html += '</li>';
                    });
                    html += '</ul>';
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div class="alert alert-danger">載入分類失敗</div>';
                }
            })
            .catch(error => {
                console.error('分類載入錯誤:', error);
                document.getElementById('categories-result').innerHTML = 
                    '<div class="alert alert-danger">網路錯誤</div>';
            });

        // 測試商品 API
        fetch('api/products.php?page=1&limit=10')
            .then(response => response.json())
            .then(data => {
                console.log('商品資料:', data);
                const container = document.getElementById('products-result');
                
                if (data.success && data.products) {
                    let html = '<ul>';
                    data.products.forEach(product => {
                        html += `<li><strong>${product.name}</strong> - $${product.price}`;
                        if (product.categories && product.categories.length > 0) {
                            html += '<br>分類: ';
                            html += product.categories.map(cat => cat.name).join(', ');
                        }
                        html += '</li>';
                    });
                    html += '</ul>';
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div class="alert alert-danger">載入商品失敗</div>';
                }
            })
            .catch(error => {
                console.error('商品載入錯誤:', error);
                document.getElementById('products-result').innerHTML = 
                    '<div class="alert alert-danger">網路錯誤</div>';
            });
    </script>
</body>
</html>
