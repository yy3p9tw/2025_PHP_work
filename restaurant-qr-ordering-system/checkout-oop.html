<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçΩÔ∏è ÁµêÂ∏≥ - È§êÂª≥ÈªûÈ§êÁ≥ªÁµ± (OOPÁâà)</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Ëá™ÂÆöÁæ©Ê®£Âºè -->
    <link href="css/styles.css" rel="stylesheet">
</head>
<body>
    <!-- Â∞éËà™Ê¨Ñ -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="fas fa-utensils me-2"></i>
                È§êÂª≥ÈªûÈ§êÁ≥ªÁµ±
            </a>
            
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3" id="currentTableNumber">
                    Â∫ßËôüÔºöËºâÂÖ•‰∏≠...
                </span>
                <a class="nav-link" href="cart.html">
                    <i class="fas fa-shopping-cart me-1"></i>
                    Ë≥ºÁâ©Ëªä
                    <span class="badge bg-danger ms-1 cart-badge" style="display: none;">0</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- ‰∏ªË¶ÅÂÖßÂÆπ -->
    <main class="container mt-4">
        <!-- ËºâÂÖ•ÁãÄÊÖã -->
        <div id="loading" class="text-center py-5 d-none">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">ËºâÂÖ•‰∏≠...</span>
            </div>
            <p class="mt-2">ËºâÂÖ•‰∏≠...</p>
        </div>

        <!-- ÈåØË™§Ë®äÊÅØ -->
        <div id="errorMessage" class="alert alert-danger d-none" role="alert">
            ÈåØË™§Ë®äÊÅØÊúÉÈ°ØÁ§∫Âú®ÈÄôË£°
        </div>

        <!-- ÁµêÂ∏≥ÂÖßÂÆπ -->
        <div class="row">
            <div class="col-lg-8">
                <!-- Ë®ÇÂñÆÊëòË¶Å -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-receipt me-2"></i>
                            Ë®ÇÂñÆÊëòË¶Å
                        </h5>
                    </div>
                    <div class="card-body" id="orderSummary">
                        <div id="orderItems">
                            <!-- Ë®ÇÂñÆÈ†ÖÁõÆÊúÉÂú®ÈÄôË£°ÂãïÊÖãËºâÂÖ• -->
                        </div>
                    </div>
                </div>

                <!-- ‰ªòÊ¨æÊñπÂºè -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-credit-card me-2"></i>
                            ‰ªòÊ¨æÊñπÂºè
                        </h5>
                    </div>
                    <div class="card-body">
                        <div id="payment-methods">
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="cash" value="cash" checked>
                                <label class="form-check-label" for="cash">
                                    <i class="fas fa-money-bill-wave me-2"></i>
                                    ÁèæÈáë‰ªòÊ¨æ
                                    <small class="text-muted d-block">Ë´ãËá≥Ê´ÉÊ™ØÂÆåÊàê‰ªòÊ¨æ</small>
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="credit_card" value="credit_card">
                                <label class="form-check-label" for="credit_card">
                                    <i class="fas fa-credit-card me-2"></i>
                                    ‰ø°Áî®Âç°
                                    <small class="text-muted d-block">Ë´ãËá≥Ê´ÉÊ™ØÂÆåÊàê‰ªòÊ¨æ</small>
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="radio" name="paymentMethod" id="mobile_payment" value="mobile_payment">
                                <label class="form-check-label" for="mobile_payment">
                                    <i class="fas fa-mobile-alt me-2"></i>
                                    Ë°åÂãïÊîØ‰ªò
                                    <small class="text-muted d-block">Line Pay / Apple Pay / Google Pay</small>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- È°ßÂÆ¢ÂÇôË®ª -->
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-comment me-2"></i>
                            ÂÇôË®ª
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <textarea 
                                class="form-control" 
                                id="customerNote" 
                                rows="3" 
                                placeholder="Ë´ãËº∏ÂÖ•ÁâπÊÆäÈúÄÊ±ÇÊàñÂÇôË®ªÔºàÈÅ∏Â°´Ôºâ"
                                maxlength="200"
                            ></textarea>
                            <div class="form-text">
                                <span id="noteCounter">0/200</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <!-- ÈáëÈ°çÊëòË¶Å -->
                <div class="card sticky-top">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-calculator me-2"></i>
                            ÈáëÈ°çÊëòË¶Å
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Â∞èË®àÔºö</span>
                            <span id="subtotalAmount">$0</span>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between mb-3">
                            <strong>Á∏ΩË®àÔºö</strong>
                            <strong id="totalAmount" class="text-primary">$0</strong>
                        </div>
                        
                        <button type="button" class="btn btn-primary btn-lg w-100" id="submitOrderBtn">
                            <span class="spinner-border spinner-border-sm me-2 d-none" role="status"></span>
                            <span class="btn-text">Á¢∫Ë™çË®ÇÂñÆ</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- ÊàêÂäüÊ®°ÊÖãÊ°Ü -->
    <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <button type="button" class="btn-close" data-dismiss="modal" aria-label="ÈóúÈñâ"></button>
                </div>
                <div class="modal-body text-center">
                    <div id="successMessage">
                        <!-- ÊàêÂäüË®äÊÅØÊúÉÂú®ÈÄôË£°ÂãïÊÖãËºâÂÖ• -->
                    </div>
                    
                    <div id="autoReturnMessage" class="mt-3">
                        <!-- Ëá™ÂãïËøîÂõûÂÄíÊï∏ÊúÉÂú®ÈÄôË£°È°ØÁ§∫ -->
                    </div>
                </div>
                <div class="modal-footer border-0 justify-content-center">
                    <button type="button" class="btn btn-outline-primary" id="continueOrderingBtn">
                        <i class="fas fa-plus me-1"></i>
                        ÁπºÁ∫åÈªûÈ§ê
                    </button>
                    <button type="button" class="btn btn-primary" id="returnHomeBtn">
                        <i class="fas fa-home me-1"></i>
                        ËøîÂõûÈ¶ñÈ†Å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- OOP Êû∂ÊßãÊ†∏ÂøÉÊ®°ÁµÑ -->
    <!-- Ê≥®ÊÑèÔºöËºâÂÖ•È†ÜÂ∫èÂæàÈáçË¶Å -->
    
    <!-- 1. Âü∫Á§éÊû∂Êßã -->
    <script src="js/core/EventBus.js"></script>
    <script src="js/core/ErrorHandler.js"></script>
    <script src="js/core/StorageService.js"></script>
    
    <!-- 2. Ê†∏ÂøÉÈ°ûÂà• -->
    <script src="js/core/BasePage.js"></script>
    <script src="js/core/ModalManager.js"></script>
    <script src="js/core/DIContainer.js"></script>
    
    <!-- 3. Ê•≠ÂãôÈÇèËºØÁÆ°ÁêÜÂô® -->
    <script src="js/managers/CartManager.js"></script>
    <script src="js/managers/OrderManager.js"></script>
    
    <!-- 4. È†ÅÈù¢È°ûÂà• -->
    <script src="js/pages/CheckoutPageOOP.js"></script>
      <!-- 5. ÊáâÁî®Á®ãÂºèÂïüÂãïÂô® -->
    <script src="js/core/bootstrap.js"></script>

    <!-- 6. ÊºîÁ§∫Â∑•ÂÖ∑ (ÂèØÈÅ∏) -->
    <script src="js/demo/OOPDemo.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Èô§ÈåØÂ∑•ÂÖ∑ (ÂÉÖÈñãÁôºÁí∞Â¢É) -->
    <script>
        // ÈñãÁôºÁí∞Â¢ÉÈô§ÈåØÂäüËÉΩ
        if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
            // ÂÖ®ÂüüÈô§ÈåØÂáΩÊï∏
            window.debug = {
                app: () => window.app?.debug(),
                eventBus: () => console.log(EventBus.getInstance().getStats()),
                errors: () => console.log(ErrorHandler.getInstance().getErrorStats()),
                container: () => console.log(window.container.getStats()),
                performance: () => console.log(window.container.get('performanceMonitor').getStats()),
                cart: () => console.log(window.container.get('cartManager').getStats()),
                orders: () => console.log(window.container.get('orderManager').getOrderStats())
            };
            
            console.log(`
                üîß ÈñãÁôºÊ®°ÂºèÈô§ÈåØÂ∑•ÂÖ∑Â∑≤ËºâÂÖ•
                ‰ΩøÁî®ÊñπÂºèÔºö
                - debug.app() - ÊáâÁî®Á®ãÂºèÁãÄÊÖã
                - debug.eventBus() - ‰∫ã‰ª∂Á≥ªÁµ±Áµ±Ë®à
                - debug.errors() - ÈåØË™§Áµ±Ë®à
                - debug.container() - ‰æùË≥¥Ê≥®ÂÖ•ÂÆπÂô®
                - debug.performance() - ÊïàËÉΩÁµ±Ë®à
                - debug.cart() - Ë≥ºÁâ©ËªäÁµ±Ë®à
                - debug.orders() - Ë®ÇÂñÆÁµ±Ë®à
            `);
        }
    </script>
</body>
</html>
